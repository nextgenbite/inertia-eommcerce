import{s as K}from"./index-CXgHXlho.js";import{s as re}from"./index-CCLBEoQa.js";import{s as ie}from"./index-BIdCN5zo.js";import{s as ne}from"./index-I7wH9b21.js";import{s as de}from"./index-Cbiimzco.js";import{c as ce}from"./index-CY3Z4h97.js";import{s as me}from"./index-nZ50JOjL.js";import{s as X}from"./index-BSwh4WZO.js";import{s as ue,a as pe}from"./index-CftzfXk6.js";import{s as Y}from"./index-BOTF6nDU.js";import{_ as A,T as H,a3 as Z,z as P,o as l,c as V,w as _,b as k,e as ee,f as y,F as L,X as N,n as M,t as T,u as p,a as u,g as E,ac as te,$ as ye,a0 as ge,a1 as Q,R as q,a2 as J,d as G,q as he}from"./app-D7NVjfTE.js";import{s as ae}from"./index-CBcP_mBc.js";import{s as oe}from"./index-BN5QB6YX.js";import{s as le}from"./index-qADclmDw.js";import{_ as se}from"./MultipleImageUpload-CBKkDX_p.js";import{p as fe}from"./lodash-DTDXzX_y.js";import{l as ve}from"./loadToast-EMyUFtut.js";const be={class:"grid grid-cols-12 gap-2"},we=["for"],ke={key:2,class:"card flex flex-col items-center gap-6"},Ve={key:0},_e=["src"],Se={key:1},$e={key:6,class:"text-red-500"},xe={class:"flex justify-end gap-2 mt-2"},Ce={__name:"Create",props:{show:Boolean,title:String,route:String,dynamicFrom:Array,modalWidth:String},emits:["close"],setup(b,{emit:j}){const i=b,D=j,v=A({});function S(){i.dynamicFrom.forEach(m=>{const a=m.type==="attribute"?[]:m.type==="images"?[]:"";v.value[m.path]=a})}S();const d=H(v.value),g=A(),c=()=>{d.post(route(`${i.route}.store`),{preserveScroll:!0,onSuccess:()=>{D("close"),d.reset()},onError:()=>null,onFinish:()=>null})};let U=!1;Z(()=>{i.show&&!U&&(U=!0,d.errors={},i.dynamicFrom.forEach(m=>{m.type==="attribute"?d[m.path]=Array.isArray(m.items)?[...m.items]:[]:m.type==="images"?d[m.path]=[]:d[m.path]=""})),i.show||(U=!1)});const O=()=>{const m=i==null?void 0:i.dynamicFrom.find(a=>a.key==="attribute");if(m&&Array.isArray(m.items)){const a=m.items[0]||{},e=Object.keys(a).reduce((o,n)=>(o[n]="",o),{});m.items.push(e),d.attribute=[...m.items]}},B=m=>{const a=i==null?void 0:i.dynamicFrom.find(e=>e.key==="attribute");a&&Array.isArray(a.items)&&(a.items.splice(m,1),d.attribute=[...a.items])};function R(m,a){const e=m.files[0];if(e&&a.type==="image"){d[a.path]=e;const o=new FileReader;o.onload=n=>{g.value=n.target.result},o.readAsDataURL(e)}}const $={1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",7:"grid-cols-7",8:"grid-cols-8",9:"grid-cols-9",10:"grid-cols-10"},W=P(()=>{const m=(d.attribute.items??[]).length;return $[m]||"grid-cols-1"});return(m,a)=>{const e=le,o=oe,n=ae,w=Y,f=X,x=K;return l(),V(x,{visible:i.show,"onUpdate:visible":a[1]||(a[1]=s=>i.show=s),position:"top",class:"capitalize",modal:"",header:"Add "+i.title,style:te({width:i.modalWidth||"32rem"}),closable:!1,maximizable:""},{default:_(()=>[k("form",{onSubmit:ee(c,["prevent"])},[k("div",be,[(l(!0),y(L,null,N(b.dynamicFrom,s=>(l(),y("div",{class:M(["field",s.class?s.class:" col-span-12"]),key:s.key},[k("label",{for:s.path},T(s.label),9,we),s.type==="textarea"?(l(),V(e,{key:0,modelValue:p(d)[s.path],"onUpdate:modelValue":t=>p(d)[s.path]=t,editorStyle:"height: 120px"},null,8,["modelValue","onUpdate:modelValue"])):s.type==="select"?(l(),V(o,{key:1,filter:"",checkmark:"",class:"w-full",id:s.path,modelValue:p(d)[s.path],"onUpdate:modelValue":t=>p(d)[s.path]=t,options:s.options,optionValue:s.optionValue,optionLabel:s.optionLabel,placeholder:"Select a "+s.label},null,8,["id","modelValue","onUpdate:modelValue","options","optionValue","optionLabel","placeholder"])):s.type==="image"?(l(),y("div",ke,[g.value?(l(),y("div",Ve,[k("img",{src:g.value,alt:"Thumbnail",class:"shadow-md rounded-xl w-full sm:w-64"},null,8,_e)])):(l(),y("div",Se,a[2]||(a[2]=[k("div",{class:"placeholder-image"},"No thumbnail selected.",-1)]))),u(n,{mode:"basic",onSelect:t=>R(t,s),auto:"",customUpload:"",accept:"image/*",chooseLabel:"Select Thumbnail",severity:"secondary",class:"p-button-outlined"},null,8,["onSelect"])])):(s==null?void 0:s.type)==="images"?(l(),V(se,{key:3,modelValue:p(d)[s.path],"onUpdate:modelValue":t=>p(d)[s.path]=t},null,8,["modelValue","onUpdate:modelValue"])):s.type==="attribute"?(l(),y("div",{key:4,class:M(["grid gap-1",W.value])},[(l(!0),y(L,null,N(p(d).attribute,(t,h)=>(l(),y("div",{key:h,class:"flex gap-2"},[(l(!0),y(L,null,N(t,(z,F)=>(l(),y("div",{key:F,class:"col-span-1"},[u(w,{modelValue:t[F],"onUpdate:modelValue":I=>t[F]=I,placeholder:F,required:"",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128)),h>0?(l(),V(f,{key:0,onClick:z=>B(h),icon:"pi pi-minus",severity:"danger",rounded:"",raised:"",outlined:"",size:"small"},null,8,["onClick"])):E("",!0)]))),128)),u(f,{onClick:O,icon:"pi pi-plus",severity:"success",rounded:"",raised:"",outlined:"",size:"small"})],2)):(l(),V(w,{key:5,class:M(["w-full",{"p-invalid":p(d).errors[[s.path]]}]),type:s==null?void 0:s.type,id:s.path,modelValue:p(d)[s.path],"onUpdate:modelValue":t=>p(d)[s.path]=t,modelModifiers:{trim:!0},autofocus:""},null,8,["type","id","modelValue","onUpdate:modelValue","class"])),p(d).errors[[s.path]]?(l(),y("small",$e,T(p(d).errors.title),1)):E("",!0)],2))),128))]),k("div",xe,[u(f,{type:"button",label:"Cancel",severity:"secondary",onClick:a[0]||(a[0]=s=>D("close"))}),u(f,{type:"submit",loading:p(d).processing,label:"Save"},null,8,["loading"])])],32)]),_:1},8,["visible","header","style"])}}},Ue={class:"grid grid-cols-12 gap-2"},Fe=["for"],Ie={key:2,class:"card flex flex-col items-center gap-6"},Ae=["src"],De={key:6,class:"text-red-500"},Oe={class:"flex justify-end gap-2 mt-4"},ze={__name:"Edit",props:{show:Boolean,title:String,route:String,data:Object,dynamicFrom:Array,modalWidth:String},emits:["close"],setup(b,{emit:j}){const i=b,D=j,v=A(null),S=A({});function d(){i.dynamicFrom.forEach(e=>{const o=e.type==="attribute"?[]:e.type==="select"&&e.options[0]?e.options[0][e.optionValue]||"":e.type==="images"?[]:"";S.value[e.path]=o})}function g(e,o,n){if(!o||o.length===0)return e;const w=o[0][n],f=typeof w=="number",x=typeof w=="boolean";return f?Number(e):x?e==="true"||e===!0:String(e)}d();const c=H({_method:"put",...S.value}),U=()=>{var e;c.post(route(`${i.route}.update`,(e=i.data)==null?void 0:e.id),{preserveScroll:!0,onSuccess:()=>{D("close"),c.reset()}})};let O=!1;Z(()=>{i.show&&!O&&(O=!0,c.errors={},i.dynamicFrom.forEach(e=>{if(e.type==="image")v.value="/"+i.data[e.path];else if(e.type==="images")c[e.path]=[];else if(e.type==="attribute"){const o=i.data[e.path]?JSON.parse(i.data[e.path]):[];e.items=o.map(n=>Object.keys(e.items[0]||{}).reduce((w,f)=>(w[f]=n[f]||"",w),{})),c[e.key]=[...e.items]}else e.type==="select"?c[e.path]=g(i.data[e.path],e.options,e.optionValue):c[e.path]=i.data[e.path]??""})),i.show||(O=!1)});const B=()=>{const e=i.dynamicFrom.find(o=>o.key==="attribute");if(e&&Array.isArray(e.items)){const o=Object.keys(e.items[0]||{}).reduce((n,w)=>(n[w]="",n),{});e.items.push(o),c[e.type]=[...e.items]}},R=e=>{const o=i.dynamicFrom.find(n=>n.key==="attribute");o&&Array.isArray(o.items)&&(o.items.splice(e,1),c[o.type]=[...o.items])},$=(e,o)=>{const n=e.files[0];if(n&&o.type==="image"){c[o.path]=n;const w=new FileReader;w.onload=f=>{v.value=f.target.result},w.readAsDataURL(n)}};function W(e){try{return(typeof e=="string"?JSON.parse(e):e||[]).map(n=>typeof n=="string"?{url:"/"+n,name:n.split("/").pop()}:n)}catch{return[]}}const m={1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",7:"grid-cols-7",8:"grid-cols-8",9:"grid-cols-9",10:"grid-cols-10"},a=P(()=>{const e=(c.attribute.items??[]).length;return m[e]||"grid-cols-1"});return(e,o)=>{const n=oe,w=ae,f=Y,x=X,s=K;return l(),V(s,{visible:i.show,"onUpdate:visible":o[1]||(o[1]=t=>i.show=t),position:"top",modal:"",header:"Update "+i.title,style:te({width:i.modalWidth||"32rem"}),closable:!1},{default:_(()=>[k("form",{onSubmit:ee(U,["prevent"])},[k("div",Ue,[(l(!0),y(L,null,N(b.dynamicFrom,t=>(l(),y("div",{key:t.key,class:M(["field col-span-12",t.class||""])},[k("label",{for:t.path},T(t.label),9,Fe),t.type==="textarea"?(l(),V(p(le),{key:0,modelValue:p(c)[t.path],"onUpdate:modelValue":h=>p(c)[t.path]=h,editorStyle:"height: 120px"},null,8,["modelValue","onUpdate:modelValue"])):t.type==="select"?(l(),V(n,{key:1,class:"w-full",modelValue:p(c)[t.path],"onUpdate:modelValue":h=>p(c)[t.path]=h,options:t.options,optionValue:t.optionValue,optionLabel:t.optionLabel,placeholder:"Select "+t.label},null,8,["modelValue","onUpdate:modelValue","options","optionValue","optionLabel","placeholder"])):t.type==="image"?(l(),y("div",Ie,[v.value?(l(),y("img",{key:0,src:v.value,alt:"Thumbnail",class:"shadow-md rounded-xl w-full sm:w-64"},null,8,Ae)):E("",!0),u(w,{mode:"basic",onSelect:h=>$(h,t),auto:"",customUpload:"",accept:"image/*",chooseLabel:"Select Thumbnail"},null,8,["onSelect"])])):(t==null?void 0:t.type)==="images"?(l(),V(se,{key:3,modelValue:p(c)[t.path],"onUpdate:modelValue":h=>p(c)[t.path]=h,existingImages:W(b.data[t.path]),"onUpdate:existingImages":h=>p(c)[t.path]=h},null,8,["modelValue","onUpdate:modelValue","existingImages","onUpdate:existingImages"])):t.type==="attribute"?(l(),y("div",{key:4,class:M(["grid gap-1",a.value])},[(l(!0),y(L,null,N(p(c).attribute,(h,z)=>(l(),y("div",{key:z,class:"flex gap-2"},[(l(!0),y(L,null,N(h,(F,I)=>(l(),y("div",{key:I,class:"col-span-1"},[u(f,{modelValue:h[I],"onUpdate:modelValue":r=>h[I]=r,placeholder:I,required:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128)),z>0?(l(),V(x,{key:0,onClick:F=>R(z),icon:"pi pi-minus",severity:"danger",rounded:"",raised:"",outlined:"",size:"small"},null,8,["onClick"])):E("",!0)]))),128)),u(x,{onClick:B,icon:"pi pi-plus",severity:"success",rounded:"",raised:"",outlined:"",size:"small"})],2)):(l(),V(f,{key:5,class:"w-full",modelValue:p(c)[t.path],"onUpdate:modelValue":h=>p(c)[t.path]=h,type:t.type},null,8,["modelValue","onUpdate:modelValue","type"])),p(c).errors[t.path]?(l(),y("small",De,T(p(c).errors[t.path]),1)):E("",!0)],2))),128))]),k("div",Oe,[u(x,{label:"Cancel",severity:"secondary",onClick:o[0]||(o[0]=t=>D("close"))}),u(x,{type:"submit",label:"Update",loading:p(c).processing},null,8,["loading"])])],32)]),_:1},8,["visible","header","style"])}}},Le={class:"card"},Ne={class:"flex justify-center lg:justify-between flex-col lg:flex-row gap-2"},Te={key:3},Be={key:4,class:"capitalize truncate"},Ee={class:"flex items-center",style:{height:"17px","flex-grow":"1",overflow:"hidden"}},je={class:"flex items-center gap-4"},Re={key:0},st={__name:"Table",props:{title:Array,filters:Object,getData:Object,perPage:Number,modal_width:String,columns:{type:Array,required:!0},dynamicFrom:{type:Array,required:!0},route:{type:String,required:!0}},setup(b){const{_:j,debounce:i,pickBy:D}=fe,v=b;ve();const S=A(!1),d=H({}),g=ye({params:{search:v.filters.search,field:v.filters.field,order:v.filters.order,createOpen:!1,editOpen:!1},item:null}),c=()=>{var a;S.value=!1,d.delete(route(`${v.route}.destroy`,(a=g.item)==null?void 0:a.id),{preserveScroll:!0,onSuccess:()=>{d.reset()},onError:()=>null,onFinish:()=>null})},U=A(),O=a=>{Q.get(route(`${v.route}.index`),{page:a.page+1},{preserveState:!0})};ge(()=>j.cloneDeep(g.params),i(()=>{let a=D(g.params);Q.get(route(`${v.route}.index`),a,{replace:!0,preserveState:!0,preserveScroll:!0})},150));const B=A(),R=()=>{B.value.exportCSV()};A({label:"Small",value:"small"});function $(a,e){return e.split(".").reduce((o,n)=>o?o[n]:"",a)}function W(a,e){const o=$(a,e);return o&&o.length>0?"/"+o:"/no-image.png"}const m=a=>{if(!a)return null;const e=String(a).toLowerCase();if(console.log(e),["unpaid","paid","partial"].includes(e))switch(e){case"unpaid":return"danger";case"paid":return"success";case"partial":return"warning"}if(["cod","pickup","courier"].includes(e))switch(e){case"cod":return"info";case"pickup":return"success";case"courier":return"warning"}if(["pending","shipped","delivered","cancelled"].includes(e))switch(e){case"pending":return"info";case"shipped":return"warning";case"delivered":return"success";case"cancelled":return"danger"}return null};return(a,e)=>{const o=ue,n=Y,w=pe,f=X,x=me,s=ce,t=de,h=ne,z=ie,F=re,I=K;return l(),y("div",Le,[u(Ce,{show:g.createOpen,onClose:e[0]||(e[0]=r=>g.createOpen=!1),title:v.title[1],dynamicFrom:b.dynamicFrom,route:b.route,modalWidth:v.modal_width||"60rem"},null,8,["show","title","dynamicFrom","route","modalWidth"]),u(ze,{show:g.editOpen,onClose:e[1]||(e[1]=r=>g.editOpen=!1),data:g.item,title:v.title[1],dynamicFrom:b.dynamicFrom,route:b.route,modalWidth:v.modal_width||"60rem"},null,8,["show","data","title","dynamicFrom","route","modalWidth"]),u(F,{selection:U.value,"onUpdate:selection":e[5]||(e[5]=r=>U.value=r),ref_key:"dt",ref:B,size:"small",lazy:"",stripedRows:"",loading:!b.getData.data,value:b.getData.data,paginator:"",rows:b.getData.per_page,totalRecords:b.getData.total,first:(b.getData.current_page-1)*b.getData.per_page,onPage:O,l:""},{header:_(()=>[k("div",Ne,[u(w,null,{default:_(()=>[u(o,null,{default:_(()=>e[8]||(e[8]=[k("i",{class:"pi pi-search"},null,-1)])),_:1,__:[8]}),u(n,{modelValue:g.params.search,"onUpdate:modelValue":e[2]||(e[2]=r=>g.params.search=r),placeholder:"Keyword Search",class:"w-full"},null,8,["modelValue"])]),_:1}),u(x,null,{default:_(()=>[q(u(f,{label:"Create",onClick:e[3]||(e[3]=r=>g.createOpen=!0),icon:"pi pi-plus"},null,512),[[J,a.can([a.$page.props.permissions.create])]]),u(f,{icon:"pi pi-external-link",label:"Export",onClick:e[4]||(e[4]=r=>R(r))})]),_:1})])]),empty:_(()=>e[9]||(e[9]=[k("div",{class:"text-center"},"No data found.",-1)])),loading:_(()=>e[10]||(e[10]=[G(" Loading data. Please wait. ")])),default:_(()=>[u(s,{selectionMode:"multiple",headerStyle:"width: 3rem"}),(l(!0),y(L,null,N(v.columns,r=>(l(),V(s,{field:r.path,header:r.label,sortable:r==null?void 0:r.sort,headerStyle:"min-width:10rem;",key:r.key},{body:_(C=>[r.key==="image"?(l(),V(t,{key:0,src:W(C.data,r.path),alt:r.label,class:"shadow-2 rounded",width:"100",preview:""},null,8,["src","alt"])):r.key==="tag"?(l(),V(h,{key:1,value:$(C.data,r.path),severity:m($(C.data,r.path))},null,8,["value","severity"])):r.key==="status"?(l(),V(h,{key:2,value:$(C.data,r.path)==1?"Active":"Inactive",severity:$(C.data,r.path)==1?"success":"danger"},null,8,["value","severity"])):r.path.includes(".")?(l(),y("div",Te,T($(C.data,r.path)),1)):(l(),y("div",Be,T(C.data[r.path]),1))]),_:2},1032,["field","header","sortable"]))),128)),u(s,{exportable:!1,style:{"min-width":"12rem"}},{loading:_(()=>[k("div",Ee,[u(z,{width:"30%",height:"1rem"})])]),body:_(r=>[he(a.$slots,"button",{item:r.data}),q(u(f,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:C=>(g.editOpen=!0,g.item=r.data)},null,8,["onClick"]),[[J,a.can([a.$page.props.permissions.update])]]),q(u(f,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:C=>{S.value=!0,g.item=r.data}},null,8,["onClick"]),[[J,a.can([a.$page.props.permissions.delete])]])]),_:3})]),_:3},8,["selection","loading","value","rows","totalRecords","first"]),u(I,{visible:S.value,"onUpdate:visible":e[7]||(e[7]=r=>S.value=r),style:{width:"450px"},header:"Confirm",modal:!0},{footer:_(()=>[u(f,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=r=>S.value=!1)}),u(f,{label:"Yes",icon:"pi pi-check",onClick:c})]),default:_(()=>[k("div",je,[e[13]||(e[13]=k("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),g.item?(l(),y("span",Re,[e[11]||(e[11]=G("Are you sure you want to delete ")),k("b",null,T(g.item.title),1),e[12]||(e[12]=G("?"))])):E("",!0)])]),_:1},8,["visible"])])}}};export{st as _};
